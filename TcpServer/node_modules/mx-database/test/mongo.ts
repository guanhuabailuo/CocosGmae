import { MongodbMoudle } from "../src"

MongodbMoudle.regist_colltion("test", "libtest", [])
MongodbMoudle.regist_index("test", "libtest", "createAt", {
    expireAfterSeconds: 120
})


describe("测试", function () {
    before(async function () {
        this.timeout(5000)
        await MongodbMoudle.init([{ host: "10.0.0.10", port: 27017 }])
        return true;
    })

    it("insert", async function () {
        let v = await MongodbMoudle.get_database("test").insert("libtest", { name: "nihao" })
        return true
    })

    it("list", async function () {

        let vDB = MongodbMoudle.get_database("test").get_list("libtest", { name: "nihao" });
        let v1 = await vDB.load()
        console.log(v1.data, Date.now());

        return true;
    })

    it("unit", async function () {
        let v = await MongodbMoudle.get_database("test").get_unit("libtest", { name: "nihao" }).load()
        console.log(JSON.stringify(v.data))
        return true;
    })


    after(function (done) {
        setTimeout(function () {
            process.exit(0)
        })
        done()
    })
})